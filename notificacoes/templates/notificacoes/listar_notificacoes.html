{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>ğŸ“‹ Lista de NotificaÃ§Ãµes</h2>
    <a href="{% url 'criar_notificacao' %}" class="btn btn-success">
      â• Nova NotificaÃ§Ã£o
    </a>
  </div>

  <!-- ğŸ”¹ FormulÃ¡rio de Filtros -->
  <div class="card shadow p-4">
    <form method="GET">
      <div class="row">
        <!-- ğŸ”¹ Campo Loja -->
        <div class="col-md-4">
          <label class="fw-bold">ğŸ¬ Loja:</label>
          <input type="text" class="form-control" name="loja" placeholder="Nome da loja" value="{{ loja }}">
        </div>

        <!-- ğŸ”¹ Campo Data -->
        <div class="col-md-4">
          <label class="fw-bold">ğŸ“… Data:</label>
          <input type="text" class="form-control datepicker" name="data" placeholder="dd/mm/aaaa" value="{{ data }}">
        </div>

        <!-- ğŸ”¹ Campo Motivo -->
        <div class="col-md-4">
          <label class="fw-bold">âš  Motivo:</label>
          <input type="text" class="form-control" name="motivo" placeholder="Motivo da notificaÃ§Ã£o" value="{{ motivo }}">
        </div>
      </div>

      <div class="mt-3 text-center">
        <button type="submit" class="btn btn-primary">ğŸ” Filtrar</button>
        <a href="{% url 'listar_notificacoes' %}" class="btn btn-secondary">ğŸ”„ Limpar</a>
      </div>
    </form>
  </div>

  <!-- ğŸ”¹ Tabela de NotificaÃ§Ãµes -->
  <div class="card mt-4 shadow">
    <div class="card-body">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>ğŸ¬ Loja</th>
            <th>ğŸ“… Data</th>
            <th>ğŸ•’ Hora</th>
            <th>âš  Motivo</th>
            <th>ğŸ”§ AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody>
          {% for notificacao in notificacoes %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ notificacao.loja }}</td>
            <td>{{ notificacao.data_ocorrencia|date:"d/m/Y" }}</td>
            <td>{{ notificacao.hora_ocorrencia|time:"H:i" }}</td>
            <td>{{ notificacao.motivo }}</td>
            <td>
              <a href="{% url 'detalhar_notificacao' notificacao.id %}" class="btn btn-info btn-sm">ğŸ” Ver</a>
              <a href="{% url 'editar_notificacao' notificacao.id %}" class="btn btn-warning btn-sm">âœ Editar</a>
              <a href="{% url 'baixar_pdf_notificacao' notificacao.id %}" class="btn btn-primary btn-sm">ğŸ“„ PDF</a>
              <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Tem certeza que deseja excluir esta notificaÃ§Ã£o?');">ğŸ—‘ï¸ Deletar</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" class="text-center text-muted">âš  Nenhuma notificaÃ§Ã£o encontrada.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- ğŸ”¹ Adicionando JavaScript para Datepicker -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    let datepickers = document.querySelectorAll(".datepicker");
    datepickers.forEach(input => {
      input.setAttribute("type", "date");
    });
  });
</script>

{% endblock %}
