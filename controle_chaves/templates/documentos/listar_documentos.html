{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">üìú Documentos Fundamentais</h2>

    <a href="{% url 'adicionar_documento' %}" class="btn btn-primary mb-3">‚ûï Adicionar Documento</a>

    <table class="table table-bordered text-center">
        <thead class="table-dark">
            <tr>
                <th>Nome</th>
                <th>Emiss√£o</th>
                <th>Vencimento</th>
                <th>Entidade</th>
                <th>Fun√ß√£o</th>
                <th>Status</th>
                <th>√Årea</th>
                <th>Arquivo</th>
                <th>A√ß√µes</th>
            </tr>
        </thead>
        <tbody>
            {% for documento in documentos %}
                <tr>
                    <td>{{ documento.nome_documento }}</td>
                    <td>{{ documento.emissao|date:"d/m/Y" }}</td>
                    <td>{{ documento.vencimento|date:"d/m/Y" }}</td>
                    <td>{{ documento.entidade_emissora }}</td>
                    <td>{{ documento.funcao_documento }}</td>
                    <td>
                        {% if documento.status == "No Prazo" %}
                            <span class="badge bg-success">üü¢ No Prazo</span>
                        {% elif documento.status == "Renovar" %}
                            <span class="badge bg-warning text-dark">üü° Renovar</span>
                        {% else %}
                            <span class="badge bg-danger">üî¥ Vencido</span>
                        {% endif %}
                    </td>
                    <td>{{ documento.area }}</td>
                    <td>
                        {% if documento.arquivo %}
                            <a href="{{ documento.arquivo.url }}" target="_blank" class="btn btn-info btn-sm">
                                üìÑ Ver Imagem
                        {% else %}
                            ‚ùå Sem Documento
                        {% endif %}
                    </td>
                    <td class="text-center">
                        <div class="d-flex justify-content-center gap-2">
                            <a href="{% url 'editar_documento' documento.id %}" class="btn btn-warning btn-sm">‚úèÔ∏è Editar</a>
                            
                            <!-- Bot√£o para abrir modal de exclus√£o -->
                            <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal{{ documento.id }}">
                                üóëÔ∏è Excluir
                            </button>
                        </div>
                    </td>
                </tr>

                <!-- üîπ Modal de Confirma√ß√£o -->
                <div class="modal fade" id="confirmDeleteModal{{ documento.id }}" tabindex="-1" aria-labelledby="confirmDeleteLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="confirmDeleteLabel">üõë Confirmar Exclus√£o</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                Tem certeza que deseja excluir <strong>{{ documento.nome_documento }}</strong>? Esta a√ß√£o n√£o pode ser desfeita.
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                <a href="{% url 'excluir_documento' documento.id %}" class="btn btn-danger">üóëÔ∏è Confirmar Exclus√£o</a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
